{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","negociacao","adiciona","catch","erro","texto","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","err","textoParaData","value","parseInt","parseFloat","focus","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import { ListaNegociacoes } from \"../models/ListaNegociacoes\";\nimport { Mensagem } from \"../models/Mensagem\";\nimport { NegociacoesView } from \"../views/NegociacoesView\";\nimport { MensagemView } from \"../views/MensagemView\";\nimport { NegociacaoService } from \"../services/NegociacaoService\";\nimport { DateHelper } from \"../helpers/DateHelper\";\nimport { Bind } from \"../helpers/Bind\";\nimport { Negociacao } from \"../models/Negociacao\";\n\nclass NegociacaoController {\n  constructor() {\n    let $ = document.querySelector.bind(document);\n\n    this._inputData = $(\"#data\");\n    this._inputQuantidade = $(\"#quantidade\");\n    this._inputValor = $(\"#valor\");\n\n    this._listaNegociacoes = new Bind(\n      new ListaNegociacoes(),\n      new NegociacoesView($(\"#negociacoesView\")),\n      \"adiciona\",\n      \"esvazia\"\n    );\n\n    this._mensagem = new Bind(\n      new Mensagem(),\n      new MensagemView($(\"#mensagemView\")),\n      \"texto\"\n    );\n\n    this._ordemAtual = \"\";\n    this._service = new NegociacaoService();\n    this._init();\n  }\n\n  _init() {\n    this._service\n      .lista()\n      .then((negociacoes) =>\n        negociacoes.forEach((negociacao) =>\n          this._listaNegociacoes.adiciona(negociacao)\n        )\n      )\n      .catch((erro) => (this._mensagem.texto = erro));\n\n    setInterval(() => {\n      this.importaNegociacoes();\n    }, 3000);\n  }\n\n  adiciona(event) {\n    event.preventDefault();\n\n    let negociacao = this._criaNegociacao();\n    this._service\n      .cadastra(negociacao)\n      .then((mensagem) => {\n        this._listaNegociacoes.adiciona(negociacao);\n        this._mensagem.texto = mensagem;\n        this._limpaFormulario();\n      })\n      .catch((erro) => (this._mensagem.texto = erro));\n  }\n\n  importaNegociacoes() {\n    this._service\n      .importa(this._listaNegociacoes.negociacoes)\n\n      .then((negociacoes) =>\n        negociacoes.forEach((negociacao) => {\n          this._listaNegociacoes.adiciona(negociacao);\n          this._mensagem.texto = \"Negociações do período importadas\";\n        })\n      )\n      .catch((erro) => (this._mensagem.texto = erro));\n  }\n\n  apaga() {\n    this._service\n      .apaga()\n      .then((mensagem) => {\n        this._mensagem.texto = mensagem;\n        this._listaNegociacoes.esvazia();\n      })\n      .catch((err) => (this._mensagem.texto = err));\n  }\n\n  _criaNegociacao() {\n    return new Negociacao(\n      DateHelper.textoParaData(this._inputData.value),\n      parseInt(this._inputQuantidade.value),\n      parseFloat(this._inputValor.value)\n    );\n  }\n\n  _limpaFormulario() {\n    this._inputData.value = \"\";\n    this._inputQuantidade.value = 1;\n    this._inputValor.value = 0.0;\n    this._inputData.focus();\n  }\n}\n\nlet negociacaoController = new NegociacaoController()\n\nexport function currentInstance() {\n  return negociacaoController;\n}\n"]}